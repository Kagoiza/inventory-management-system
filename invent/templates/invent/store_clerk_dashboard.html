{% extends 'invent/base_store_clerk.html' %} {# Extend the responsive base template #}
{% load static %}

{% block title %}Store Clerk Dashboard{% endblock %} {# Set page title #}

{% block content %} {# Content for the main area #}
    <h2 class="mb-3">Hello {{ user.first_name|default:user.username }}</h2>

    <div class="d-flex flex-wrap gap-3 mb-4"> {# flex-wrap to stack buttons on small screens #}
        <a class="btn btn-outline-primary" href="{% url 'issue_item' %}">üì§ Issue Item</a>
        <a class="btn btn-outline-secondary" href="{% url 'manage_stock' %}">‚öôÔ∏è Manage Stock</a>
        <a class="btn btn-outline-dark" href="{% url 'adjust_stock' %}">üîß Adjust Stock</a>
        <a class="btn btn-outline-success" href="{% url 'upload_inventory' %}">üì• Upload Inventory</a>
    </div>

    <div class="row text-center mb-4">
        <div class="col-sm-6 col-md-3 mb-3"> {# Responsive columns for cards #}
            <div class="dashboard-card bg-success text-white p-3 rounded shadow-sm"> {# Added p-3, rounded, shadow-sm #}
                <h6>Total Inventory Items</h6>
                <h3>{{ total_items }}</h3>
            </div>
        </div>
        <div class="col-sm-6 col-md-3 mb-3">
            <div class="dashboard-card bg-light border p-3 rounded shadow-sm">
                <h6>Quantity Issued</h6>
                <h3>{{ items_issued }}</h3>
            </div>
        </div>
        <div class="col-sm-6 col-md-3 mb-3">
            <div class="dashboard-card bg-light border p-3 rounded shadow-sm">
                <h6>Quantity Returned</h6>
                <h3>{{ items_returned }}</h3>
            </div>
        </div>
        <div class="col-sm-6 col-md-3 mb-3">
            <div class="dashboard-card bg-warning text-dark p-3 rounded shadow-sm">
                <h6>Pending Requests</h6>
                <h3>{{ pending_requests_count }}</h3>
            </div>
        </div>
    </div>

    <div class="bg-white p-4 rounded shadow-sm mb-4">
        <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap"> {# flex-wrap for header on small screens #}
            <h5 class="mb-2 mb-sm-0">Recent Inventory Activity</h5> {# Added margin bottom for small screens #}
            <div class="d-flex gap-2"> {# Use gap-2 for spacing #}
                <a href="{% url 'manage_stock' %}" class="btn btn-sm btn-outline-primary">View All Stock</a>
            </div>
        </div>
        <div class="table-responsive"> {# Make table responsive #}
            <table class="table table-hover">
                <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Category</th>
                        <th>Total Qty</th>
                        <th>Issued Qty</th>
                        <th>Returned Qty</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr>
                        <td>{{ item.id }}</td>
                        <td>{{ item.name }}</td>
                        <td>{{ item.category|default:"N/A" }}</td>
                        <td>{{ item.quantity_total }}</td>
                        <td>{{ item.quantity_issued }}</td>
                        <td>{{ item.quantity_returned }}</td>
                        <td>
                            <span class="badge
                                {% if item.status == 'Approved' or item.status == 'In Stock' %}bg-success
                                {% elif item.status == 'Pending' %}bg-info
                                {% elif item.status == 'Issued' %}bg-primary
                                {% elif item.status == 'Returned' %}bg-secondary
                                {% elif item.is_expired %}bg-dark text-white
                                {% elif item.quantity_remaining <= 5 and item.quantity_remaining > 0 %}bg-warning text-dark
                                {% elif item.quantity_remaining <= 0 %}bg-danger
                                {% else %}bg-info{% endif %}">
                                {{ item.status }}{% if item.is_expired %} (Expired){% endif %}
                            </span>
                        </td>
                        <td><a href="{% url 'edit_item' item.id %}" class="text-success fw-bold">View/Edit</a></td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="8" class="text-center text-muted">No recent inventory items found.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
{# Any page-specific JavaScript can go here #}
{% endblock %}